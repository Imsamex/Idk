-- Variables
local workspace = game:GetService("Workspace")
local players = game:GetService("Players")
local localPlayer = players.LocalPlayer
local camera = workspace.CurrentCamera
local ballName = "SoccerBall"
local currentBall = nil
local espParts = {}
local featureEnabled = {
    autoHit = false,
    espBall = true,
    hitbox = false,
    viewBall = false,
    lockOnBall = false
}

-- Function to find the ball
local function findBallInWorkspace()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and obj.Name == ballName then
            return obj
        end
    end
    return nil
end

-- Function to create/update ESP
local function createOrUpdateESP(ball)
    if espParts[ball] then return end

    local espPart = Instance.new("BillboardGui")
    espPart.Size = UDim2.new(0, 200, 0, 50)
    espPart.AlwaysOnTop = true
    espPart.Adornee = ball
    espPart.Parent = ball

    local ballText = Instance.new("TextLabel")
    ballText.Size = UDim2.new(1, 0, 0.3, 0)
    ballText.Position = UDim2.new(0, 0, -0.2, 0)
    ballText.TextColor3 = Color3.fromRGB(255, 255, 255)
    ballText.TextScaled = true
    ballText.Text = "Ball"
    ballText.BackgroundTransparency = 1
    ballText.Parent = espPart

    local distanceText = Instance.new("TextLabel")
    distanceText.Size = UDim2.new(1, 0, 0.3, 0)
    distanceText.Position = UDim2.new(0, 0, 0.3, 0)
    distanceText.TextColor3 = Color3.fromRGB(255, 255, 255)
    distanceText.TextScaled = true
    distanceText.Text = "Distance: 0"
    distanceText.BackgroundTransparency = 1
    distanceText.Parent = espPart

    espParts[ball] = { esp = espPart, distanceText = distanceText }

    coroutine.wrap(function()
        while ball and ball.Parent do
            local distance = (localPlayer.Character.HumanoidRootPart.Position - ball.Position).Magnitude
            distanceText.Text = "Distance: " .. math.floor(distance)
            wait(0.1)
        end
        if espParts[ball] then
            espParts[ball].esp:Destroy()
            espParts[ball] = nil
        end
    end)()
end

-- Function to lock the camera onto the ball
local function camlockToBall(ball)
    if not featureEnabled.lockOnBall then return end
    camera.CameraType = Enum.CameraType.Scriptable
    camera.CFrame = CFrame.new(camera.CFrame.Position, ball.Position)
end

-- Function to reset the camera
local function resetCamera()
    camera.CameraType = Enum.CameraType.Custom
end

-- Function to create a UI button to toggle features
local function createFeatureUI()
    local screenGui = Instance.new("ScreenGui", localPlayer.PlayerGui)
    local frame = Instance.new("Frame", screenGui)
    frame.Size = UDim2.new(0, 200, 0, 300)
    frame.Position = UDim2.new(0, 10, 0, 10)
    frame.BackgroundTransparency = 0.3

    -- Create buttons for each feature
    local yOffset = 10

    local function createButton(name, callback)
        local button = Instance.new("TextButton", frame)
        button.Size = UDim2.new(1, 0, 0, 30)
        button.Position = UDim2.new(0, 0, 0, yOffset)
        button.Text = name
        button.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.MouseButton1Click:Connect(callback)
        yOffset = yOffset + 35
    end

    createButton("Toggle ESP", function()
        featureEnabled.espBall = not featureEnabled.espBall
    end)

    createButton("Toggle Hitbox Size", function()
        featureEnabled.hitbox = not featureEnabled.hitbox
    end)

    createButton("View Ball", function()
        featureEnabled.viewBall = not featureEnabled.viewBall
        if featureEnabled.viewBall then
            camlockToBall(currentBall)
        else
            resetCamera()
        end
    end)

    createButton("Lock on Ball", function()
        featureEnabled.lockOnBall = not featureEnabled.lockOnBall
    end)
end

-- Main loop to continuously search for the ball, create/update ESP, and handle features
while true do
    local ball = findBallInWorkspace()
    if ball then
        if not currentBall or currentBall ~= ball then
            currentBall = ball
            createOrUpdateESP(ball)
        end

        -- Handle camlock
        if featureEnabled.lockOnBall then
            camlockToBall(ball)
        end
    else
        -- Ball not found
        currentBall = nil
        for _, espData in pairs(espParts) do
            espData.esp:Destroy()
        end
        espParts = {}
    end

    wait(0.1)
end

-- Create the feature UI
createFeatureUI()
